(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{557:function(e,t,r){"use strict";r.r(t);var o=r(21),n=(r(64),r(176),r(5),r(77),r(118)),l={data:function(){return{search:"",value:"",dialogConfirm:!1,dialog:!1,dialogDelete:!1,confirmTitle:"",confirmMensj:"",headers:[{text:"Profesor/a",align:"start",sortable:!1,value:"nombre_completo"},{text:"Login",value:"login"},{text:"Email",value:"email"},{text:"Activo",value:"activo"},{text:"Acciones",value:"acciones",sortable:!1}],editedIndex:-1,editedItem:{id_profesor:"",nombre_completo:"",login:"",email:"",password:"",activo:null},defaultItem:{id_profesor:"",nombre_completo:"",login:"",email:"",password:"",activo:null},mensaje:{user:"",asunto:"Alta en la plataforma CPIFP Bajo Aragón",email:"",textoEmail:"",remitente:"Administrador"},activoItems:[{text:"Sí",value:1},{text:"No",value:0}]}},computed:{formTitle:function(){return-1===this.editedIndex?"Nuevo profesor/a":"Editar profesor/a"}},watch:{dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()}},methods:{isActive:function(e){return e>0},activoSelect:function(e){return e>0?"Sí":"No"},editItem:function(e){this.editedIndex=this.profesores.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem:function(e){this.editedIndex=this.profesores.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm:function(){this.delProfesor(),this.profesores.splice(this.editedIndex,1),this.closeDelete()},close:function(){var e=this;this.dialog=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}))},closeDelete:function(){var e=this;this.dialogDelete=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}))},save:function(){this.editedIndex>-1?this.updateProfesor():this.addProfesor(),this.close()},filtroBuscar:function(e,t,r){return t=t.toLowerCase(),t=removeAccents(t),null!=e&&null!=t&&"string"==typeof e&&-1!==removeAccents(e).toString().toLowerCase().indexOf(t)},addProfesor:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.generarCodigo(),r=e.editedItem,o=e.$store.state.usuario.access_token,t.next=5,n.a.postAddProfesor(r,o);case 5:201==t.sent.status?(e.enviarBienvenida(r.login,r.email,r.password),e.confirmTitle="Nuevo usuario",e.confirmMensj="Profesor/a añadido/a con éxito",e.dialogConfirm=!0,e.$parent.cargarProfesores()):e.errorMsg();case 7:case"end":return t.stop()}}),t)})))()},updateProfesor:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.editedItem,o=e.$store.state.usuario.access_token,t.next=4,n.a.postUpdateProfesor(r,o);case 4:201==t.sent.status?(e.confirmTitle="Editar profesor/a",e.confirmMensj="Profesor/a modificado/a con éxito",e.dialogConfirm=!0,e.$parent.cargarProfesores()):e.errorMsg();case 6:case"end":return t.stop()}}),t)})))()},delProfesor:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.editedItem,o=e.$store.state.usuario.access_token,t.next=4,n.a.postDelProfesor(r,o);case 4:201==t.sent.status?(e.confirmTitle="Eliminar profesor/a",e.confirmMensj="Profesor/a eliminado/a",e.dialogConfirm=!0,e.$parent.cargarProfesores()):e.errorMsg();case 6:case"end":return t.stop()}}),t)})))()},cerrarConfirm:function(){this.dialogConfirm=!1},generarCodigo:function(){for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",t="",i=8;i>0;--i)t+=e[Math.floor(Math.random()*e.length)];this.editedItem.password=t},enviarBienvenida:function(e,t,r){var l=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var c,d;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return l.mensaje.email=t,l.mensaje.textoEmail="Bienvenido/a a la plataforma del CPIFP Bajo Aragón.<br><br>Tus datos de acceso son: <br>Login: "+e+"<br>Contraseña: "+r+"<br><br>Puedes cambiar tu contraseña en el área de gestión de usuario.",c=l.mensaje,d=l.$store.state.usuario.access_token,o.next=6,n.a.postEnviarMail(c,d);case 6:o.sent.status;case 8:case"end":return o.stop()}}),o)})))()},errorMsg:function(){this.confirmTitle="Error",this.confirmMensj="Se ha producido un error.",this.dialogConfirm=!0}},props:{loadingBar:{default:"true"},profesores:{type:Array,default:[{id_profesor:"",nombre_completo:"",login:"",password:"",email:"",activo:null}]}}},c=r(52),d=r(76),m=r.n(d),v=r(232),f=r(205),h=r(75),x=r(610),_=r(442),I=r(615),k=r(532),C=r(204),w=r(611),P=r(567),j=r(544),A=r(440),V=r(464),T=r(60),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-row",[r("v-card",{staticClass:"mx-auto rounded-xl",staticStyle:{"margin-bottom":"60px"},attrs:{light:"",elevation:"24"}},[r("v-card-title",[e._v("\n        Profesores - Listado general\n      ")]),e._v(" "),r("v-data-table",{staticClass:"mx-auto",attrs:{"calculate-width":"",headers:e.headers,items:e.profesores,search:e.search,"custom-filter":e.filtroBuscar,loading:e.loadingBar,"loading-text":"Cargando datos..."},scopedSlots:e._u([{key:"top",fn:function(){return[r("v-toolbar",{attrs:{flat:""}},[r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Buscar","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),r("v-spacer"),e._v(" "),r("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,n=t.attrs;return[r("v-btn",e._g(e._b({staticClass:"mb-2",attrs:{color:"primary",dark:""}},"v-btn",n,!1),o),[e._v("\n                Insertar\n              ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[e._v(" "),r("v-card",[r("v-card-title",[r("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),e._v(" "),r("v-card-text",[r("v-container",[r("v-row",[r("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[r("v-text-field",{attrs:{label:"Nombre completo"},model:{value:e.editedItem.nombre_completo,callback:function(t){e.$set(e.editedItem,"nombre_completo",t)},expression:"editedItem.nombre_completo"}})],1),e._v(" "),r("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[r("v-text-field",{attrs:{label:"Login"},model:{value:e.editedItem.login,callback:function(t){e.$set(e.editedItem,"login",t)},expression:"editedItem.login"}})],1),e._v(" "),r("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[r("v-text-field",{attrs:{label:"Email"},model:{value:e.editedItem.email,callback:function(t){e.$set(e.editedItem,"email",t)},expression:"editedItem.email"}})],1),e._v(" "),r("v-col",{attrs:{cols:"12",sm:"6",md:"4"}}),e._v(" "),r("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[r("v-select",{attrs:{items:e.activoItems,label:"Activo","item-value":"value"},model:{value:e.editedItem.activo,callback:function(t){e.$set(e.editedItem,"activo",t)},expression:"editedItem.activo"}})],1)],1)],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v("\n                  Cancelar\n                ")]),e._v(" "),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v("\n                  Aceptar\n                ")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v("Eliminar")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-card-subtitle",{staticClass:"headline"},[e._v("¿Estás seguro de eliminar al profesor/a?")]),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Cancelar")]),e._v(" "),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteItemConfirm}},[e._v("Aceptar")]),e._v(" "),r("v-spacer")],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialogConfirm,callback:function(t){e.dialogConfirm=t},expression:"dialogConfirm"}},[r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v(e._s(e.confirmTitle))]),e._v(" "),r("v-spacer"),e._v(" "),r("v-card-subtitle",{staticClass:"headline"},[e._v(e._s(e.confirmMensj))]),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.cerrarConfirm}},[e._v("Aceptar")]),e._v(" "),r("v-spacer")],1)],1)],1)],1)]},proxy:!0},{key:"item.activo",fn:function(t){var o=t.item;return[r("v-simple-checkbox",{attrs:{value:e.isActive(o.activo),disabled:""}})]}},{key:"item.acciones",fn:function(t){var o=t.item;return[r("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(o)}}},[e._v("\n          mdi-pencil\n        ")]),e._v(" "),r("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(o)}}},[e._v("\n          mdi-delete\n        ")])]}},{key:"no-data",fn:function(){},proxy:!0}])})],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;m()(component,{VBtn:v.a,VCard:f.a,VCardActions:h.a,VCardSubtitle:h.b,VCardText:h.c,VCardTitle:h.d,VCol:x.a,VContainer:_.a,VDataTable:I.a,VDialog:k.a,VIcon:C.a,VRow:w.a,VSelect:P.a,VSimpleCheckbox:j.a,VSpacer:A.a,VTextField:V.a,VToolbar:T.a})}}]);